<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§ </text></svg>">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patient Dashboard - Mental Health System</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="theme-toggle">
    <button id="themeToggle">ğŸŒ™</button>
  </div>

  <div class="dashboard">
    <aside class="sidebar">
      <div class="sidebar-header">
        <img src="" alt="Profile" class="profile-photo-small" id="profilePhoto">
        <h3 id="userName">Loading...</h3>
        <p id="userEmail" style="font-size: 12px; color: var(--text-secondary);"></p>
      </div>
      
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="#" class="nav-link active" data-section="overview">ğŸ“Š Overview</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="todo">âœ… To-Do List</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="wellness">ğŸ’š Daily Wellness</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="resources">ğŸ“š Resources</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="telecounseling">ğŸ“¬ Telecounseling</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="chatbot">ğŸ¤– Support Bot</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="appointments">ğŸ“… Appointments</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="progress">ğŸ“ˆ Progress</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" data-section="complaint">âš ï¸ Complaint</a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link" id="logoutBtn">ğŸšª Logout</a>
        </li>
      </ul>
    </aside>

    <main class="main-content">
      <!-- Overview Section -->
      <section id="overviewSection" class="content-section active">
        <div class="header">
          <h1>Welcome Back! ğŸ‘‹</h1>
          <p class="subtitle">Here's your mental health overview</p>
        </div>
        <div class="cards-grid">
          <div class="card stat-card">
            <div class="stat-icon">âœ…</div>
            <h3>Today's Tasks</h3>
            <p class="stat-number" id="todayTasksCount">0</p>
            <small>tasks pending</small>
          </div>
          <div class="card stat-card">
            <div class="stat-icon">ğŸ”¥</div>
            <h3>Wellness Streak</h3>
            <p class="stat-number" id="wellnessStreak">0</p>
            <small>consecutive days</small>
          </div>
          <div class="card stat-card">
            <div class="stat-icon">ğŸ“Š</div>
            <h3>Weekly Avg Stress</h3>
            <p class="stat-number" id="weeklyStress">-</p>
            <small>out of 10</small>
          </div>
          <div class="card stat-card">
            <div class="stat-icon">ğŸ‘¨â€âš•ï¸</div>
            <h3>Your Doctor</h3>
            <p class="stat-number" id="doctorName">-</p>
            <small id="doctorSpec">-</small>
          </div>
        </div>

        <div class="card">
          <h3>Quick Actions</h3>
          <div class="quick-actions">
            <button class="btn btn-primary" onclick="showSection('todo')">Add Task</button>
            <button class="btn btn-primary" onclick="showSection('wellness')">Track Wellness</button>
            <button class="btn btn-primary" onclick="showSection('telecounseling')">Message Doctor</button>
            <button class="btn btn-primary" onclick="showSection('appointments')">Book Appointment</button>
          </div>
        </div>
      </section>

      <!-- To-Do Section -->
      <section id="todoSection" class="content-section">
        <div class="header">
          <h1>Daily To-Do List</h1>
          <button class="btn btn-primary" id="addTodoBtn">+ Add Task</button>
        </div>
        <div class="card">
          <div id="todoForm" style="display:none; margin-bottom: 20px;">
            <h3>Create Today's Tasks</h3>
            <div id="taskInputs"></div>
            <button class="btn btn-secondary" onclick="addTaskInput()">+ Add Another Task</button>
            <button class="btn btn-primary" onclick="saveTodoList()" style="margin-left: 10px;">Save List</button>
          </div>
          <div id="todoList">
            <p class="empty-state">No tasks for today. Click "Add Task" to create your to-do list!</p>
          </div>
        </div>
      </section>

      <!-- Wellness Tracker Section -->
      <section id="wellnessSection" class="content-section">
        <div class="header">
          <h1>Daily Wellness Tracker</h1>
          <p class="subtitle">Track your daily mood, sleep, and stress levels</p>
        </div>
        <div class="card">
          <form id="wellnessForm">
            <div class="form-group">
              <label>How are you feeling today? ğŸ˜Š</label>
              <div class="mood-selector">
                <button type="button" class="mood-btn" data-mood="ğŸ˜Š">ğŸ˜Š<br><small>Happy</small></button>
                <button type="button" class="mood-btn" data-mood="ğŸ˜">ğŸ˜<br><small>Neutral</small></button>
                <button type="button" class="mood-btn" data-mood="ğŸ˜¢">ğŸ˜¢<br><small>Sad</small></button>
                <button type="button" class="mood-btn" data-mood="ğŸ˜°">ğŸ˜°<br><small>Stressed</small></button>
                <button type="button" class="mood-btn" data-mood="ğŸ˜”">ğŸ˜”<br><small>Tired</small></button>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Sleep Hours</label>
                <input type="number" id="sleepHours" min="0" max="24" step="0.5" placeholder="e.g., 7.5" required>
              </div>
              <div class="form-group">
                <label>Stress Level (1-10)</label>
                <input type="range" id="stressLevel" min="1" max="10" value="5" required>
                <div style="text-align: center; font-size: 20px; font-weight: bold; color: var(--primary-color);">
                  <span id="stressLevelValue">5</span>/10
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Daily Notes</label>
              <textarea id="wellnessNotes" rows="3" placeholder="How was your day? What made you happy or stressed?"></textarea>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" id="todoCompleted">
                I completed all my tasks today
              </label>
            </div>
            <button type="submit" class="btn btn-primary">ğŸ’¾ Save Today's Entry</button>
          </form>
        </div>

        <div class="card" style="margin-top: 20px;">
          <h3>Recent Wellness Entries</h3>
          <div id="recentWellness"></div>
        </div>
      </section>

      <!-- Resources Section -->
      <section id="resourcesSection" class="content-section">
        <div class="header">
          <h1>Awareness Resources</h1>
          <p class="subtitle">Audio, video, and articles to support your mental health journey</p>
        </div>
        <div class="resource-filters">
          <button class="filter-btn active" data-filter="all">ğŸ“¢ All</button>
          <button class="filter-btn" data-filter="audio">ğŸµ Audio</button>
          <button class="filter-btn" data-filter="video">ğŸ¬ Video</button>
          <button class="filter-btn" data-filter="article">ğŸ“„ Articles</button>
        </div>
        <div id="resourcesList" class="cards-grid">
          <p class="empty-state">Loading resources...</p>
        </div>
      </section>

      <!-- Telecounseling Section -->
      <section id="telecounselingSection" class="content-section">
        <div class="header">
          <h1>Telecounseling</h1>
          <p class="subtitle">Connect with your doctor</p>
        </div>
        <div class="telecounseling-container">
          <div class="chat-container card">
            <div class="chat-header">
              <div style="display: flex; align-items: center; gap: 10px;">
                <img src="" alt="Doctor" id="doctorPhotoChat" class="profile-photo-small">
                <div>
                  <h3 id="doctorNameChat" style="margin: 0;">Loading...</h3>
                  <small id="doctorSpecChat" style="color: var(--text-secondary);">-</small>
                </div>
              </div>
              <div class="call-buttons">
                <button class="btn btn-success" id="audioCallBtn">ğŸ“ Audio</button>
                <button class="btn btn-primary" id="videoCallBtn">ğŸ“± Video</button>
              </div>
            </div>
            <div class="chat-messages" id="chatMessages">
              <p class="empty-state">Start a conversation with your doctor</p>
            </div>
            <div class="chat-input-container">
              <input type="text" id="messageInput" placeholder="Type your message..." class="chat-input">
              <button class="btn btn-icon" id="voiceMessageBtn" title="Record voice message">ğŸ¤</button>
              <button class="btn btn-primary" id="sendMessageBtn">Send</button>
            </div>
          </div>
        </div>

        <!-- Video Call Modal -->
        <div id="videoCallModal" class="modal" style="display: none;">
  <div class="modal-content video-call-modal">
    <div class="video-container">
      <!-- Remote Video - Full Screen - MUST have autoplay and playsinline -->
      <video id="remoteVideo" autoplay playsinline></video>
      
      <!-- Local Video - Corner - MUST have autoplay, muted, and playsinline -->
      <video id="localVideo" autoplay muted playsinline></video>
      
      <!-- Audio Only Indicator - Shows when no video -->
      <div class="audio-only-indicator">
        <div class="avatar">ğŸ¤</div>
        <div class="name">Audio Call</div>
        <div class="status">Connected</div>
      </div>
    </div>
    
    <div class="call-controls">
      <button class="btn btn-secondary" id="toggleAudioBtn" title="Mute/Unmute">ğŸ¤ Mute</button>
      <button class="btn btn-danger" id="endCallBtn" title="End Call">ğŸ“ End</button>
      <button class="btn btn-secondary" id="toggleVideoBtn" title="Video On/Off">ğŸ“¹ Video Off</button>
    </div>
  </div>
</div>

      </section>

      <!-- Chatbot Section -->
      <!-- Replace the Chatbot Section in patientdashboard.html with this -->

<!-- Chatbot Section - Professional Design -->
<section id="chatbotSection" class="content-section">
  <div class="header">
    <h1>AI Support Assistant</h1>
    <p class="subtitle">Powered by Google Gemini - Available 24/7</p>
  </div>
  
  <div class="card" style="padding: 0; overflow: hidden;">
    <div class="chatbot-container">
      <!-- Chatbot Header -->
      <div class="chatbot-header">
        <div class="chatbot-header-icon"></div>
        <div class="chatbot-header-text">
          <h3>MindCare AI Assistant</h3>
          <p>Empathetic support when you need it</p>
        </div>
        <!-- Status Indicator -->
        <div class="chatbot-status">
          <span>Online</span>
        </div>
      </div>
      
      <!-- Chatbot Messages -->
      <div class="chatbot-messages" id="chatbotMessages">
        <!-- Welcome Message -->
        <div class="chatbot-welcome">
          <div class="chatbot-welcome-icon"></div>
          <h3>Welcome to MindCare AI</h3>
          <p>I'm here to provide emotional support and listen to you. Share how you're feeling, and I'll do my best to help. Remember, I'm AI-powered support, not a replacement for professional care.</p>
        </div>
        
        <!-- Initial Bot Message -->
        <div class="bot-message">
          <div class="message-bubble">
            <p>Hello! I'm your MindCare AI Assistant. How are you feeling today? I'm here to listen and support you through whatever you're experiencing.</p>
          </div>
        </div>
      </div>
      
      <!-- Quick Reply Suggestions -->
      <div class="quick-replies">
        <button class="quick-reply-btn" onclick="sendQuickReply('I\'m feeling stressed')">Feeling stressed</button>
        <button class="quick-reply-btn" onclick="sendQuickReply('I\'m feeling anxious')">Feeling anxious</button>
        <button class="quick-reply-btn" onclick="sendQuickReply('I need someone to talk to')">Need to talk</button>
        <button class="quick-reply-btn" onclick="sendQuickReply('I\'m feeling better today')">Feeling better</button>
      </div>
      
      <!-- Input Container -->
      <div class="chat-input-container">
        <input type="text" id="chatbotInput" placeholder="Share how you're feeling..." class="chat-input">
        <button class="btn btn-primary" id="sendChatbotBtn">
          <span>Send</span>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Info Card -->
  <div class="card" style="margin-top: 24px; border-left: 4px solid #667eea; background: linear-gradient(135deg, rgba(102, 126, 234, 0.03) 0%, rgba(118, 75, 162, 0.03) 100%);">
    <div style="display: flex; gap: 20px; align-items: start;">
      <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
        <span style="font-size: 24px; font-weight: 700; color: white;">i</span>
      </div>
      <div style="flex: 1;">
        <h3 style="margin: 0 0 12px 0; font-size: 18px; color: var(--text-primary);">About This AI Assistant</h3>
        <p style="color: var(--text-secondary); line-height: 1.8; margin: 0; font-size: 15px;">
          This AI assistant uses advanced Google Gemini technology to provide empathetic, real-time emotional support. 
          While it's designed to be helpful and supportive, it's not a substitute for professional mental health care. 
          If you're experiencing a crisis or need immediate help, please contact your doctor or emergency services.
        </p>
      </div>
    </div>
  </div>
  
  <!-- Privacy Notice -->
  <div class="card" style="margin-top: 16px; background: var(--bg-secondary); border: 1px solid var(--border-color);">
    <div style="display: flex; gap: 12px; align-items: start;">
      <div style="width: 32px; height: 32px; background: var(--primary-color); border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
        <span style="font-size: 16px; color: white;">ğŸ”’</span>
      </div>
      <div style="flex: 1;">
        <h4 style="margin: 0 0 8px 0; font-size: 14px; font-weight: 600; color: var(--text-primary);">Your Privacy Matters</h4>
        <p style="color: var(--text-secondary); line-height: 1.6; margin: 0; font-size: 13px;">
          Your conversations are processed securely. We prioritize your privacy and confidentiality.
        </p>
      </div>
    </div>
  </div>
</section>

      <!-- Appointments Section -->
      <section id="appointmentsSection" class="content-section">
        <div class="header">
          <h1>Appointments</h1>
          <button class="btn btn-primary" id="bookAppointmentBtn">+ Book Appointment</button>
        </div>

        <!-- Book Appointment Form -->
        <div class="card" id="appointmentForm" style="display:none;">
          <h3>Book Offline Appointment</h3>
          <form id="newAppointmentForm">
            <div class="form-row">
              <div class="form-group">
                <label>Preferred Date</label>
                <input type="date" id="appointmentDate" required>
              </div>
              <div class="form-group">
                <label>Preferred Time</label>
                <input type="time" id="appointmentTime" required>
              </div>
            </div>
            <div class="form-group">
              <label>Reason for Visit</label>
              <textarea id="appointmentReason" rows="3" placeholder="Brief description of your concerns" required></textarea>
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-secondary" onclick="document.getElementById('appointmentForm').style.display='none'">Cancel</button>
              <button type="submit" class="btn btn-primary">Submit Request</button>
            </div>
          </form>
        </div>

        <!-- Appointments List -->
        <div id="appointmentsList">
          <p class="empty-state">No appointments scheduled</p>
        </div>
      </section>

      <!-- Progress Section -->
      <section id="progressSection" class="content-section">
        <div class="header">
          <h1>Progress Overview</h1>
          <p class="subtitle">Track your mental health journey</p>
        </div>
        
        <div class="card">
          <h3>Weekly Mood Trends</h3>
          <canvas id="moodChart" style="max-height: 300px;"></canvas>
        </div>

        <div class="card" style="margin-top: 20px;">
          <h3>Stress Level Trends</h3>
          <canvas id="stressChart" style="max-height: 300px;"></canvas>
        </div>

        <div class="cards-grid" style="margin-top: 20px;">
          <div class="card">
            <h3>Weekly Summary</h3>
            <div id="weeklySummary"></div>
          </div>
          <div class="card">
            <h3>Monthly Summary</h3>
            <div id="monthlySummary"></div>
          </div>
        </div>
      </section>

      <!-- Complaint Section -->
      <section id="complaintSection" class="content-section">
        <div class="header">
          <h1>File a Complaint</h1>
          <p class="subtitle">Report any issues or concerns</p>
        </div>
        <div class="card">
          <form id="complaintForm">
            <div class="form-group">
              <label>Complaint Against</label>
              <select id="complaintAgainst" required>
                <option value="">Select</option>
                <option value="doctor">My Doctor</option>
                <option value="system">System/Technical Issue</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-group">
              <label>Subject</label>
              <input type="text" id="complaintSubject" placeholder="Brief subject line" required>
            </div>
            <div class="form-group">
              <label>Detailed Description</label>
              <textarea id="complaintDescription" rows="6" placeholder="Please describe your complaint in detail..." required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Submit Complaint</button>
          </form>

          <div style="margin-top: 30px;">
            <h3>Your Previous Complaints</h3>
            <div id="complaintsList"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="notification" class="notification"></div>

  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script>
    // Global variables for patient dashboard
    let selectedMood = '';
    let taskCount = 1;
  </script>
  <script src="js/main.js"></script>
  <script src="js/telecommunication.js"></script>
  <script src="js/resource.js"></script>
  <script src="js/patient-dashboard.js"></script>
</body>
</html>